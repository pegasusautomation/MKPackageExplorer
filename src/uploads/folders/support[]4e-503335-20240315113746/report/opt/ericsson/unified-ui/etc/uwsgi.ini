# uwsgi.ini file
[uwsgi]

# web server port
http=127.0.0.1:8888

# Django-related settings
# the base directory (full path)
chdir           = /opt/ericsson/unified-ui/lib/python3.7/site-packages/envivio/unified
# Django's wsgi file
module          = envivio.unified.ui.wsgi:application
# the virtualenv (full path)
home            = /opt/ericsson/unified-ui
# python path
pythonpath      = /opt/ericsson/unified-ui/lib/python3.7/site-packages
# django's settings
env=DJANGO_SETTINGS_MODULE=envivio.unified.ui.settings
# External config file for Unified UI
env=UNIFIED_UI_CONFIG=/opt/ericsson/unified-ui/etc/unified-ui.ini

# process-related settings
# master
master          = true
# maximum number of worker processes
processes       = 10
# the socket (use the full path to be safe
socket          = /var/opt/ericsson/unified-ui/ui.sock
# ... with appropriate permissions - may be needed
# chmod-socket    = 664
# clear environment on exit
vacuum          = true
enable-threads  = false

# statics
offload-threads = 4
static-map = /ui/static=/opt/ericsson/unified-ui/lib/python3.7/site-packages/envivio/unified/static/
static-expires = /opt/ericsson/unified-ui/lib/python3.7/site-packages/envivio/unified/static/* 2592000 #30 days
#route = ^/favicon\.ico$ permanent-redirect:/static/favicon.ico

# other settings
#route = ^/ui/maintenance/.* harakiri:90 # respawn maintenance processes taking more than 90 seconds
#route = ^/ui/maintenance/.* last: # stop the routing chain for /ui/maintenance
#route-run = harakiri:90 # respawn all other processes taking more than 90 seconds
max-requests = 5000 # respawn processes after serving 5000 requests
pidfile=/var/opt/ericsson/unified-ui/ericsson-unified-ui-uwsgi.pid
buffer-size = 65535

# logs
req-logger = file:/var/log/ericsson/unified-ui/private/uwsgi-access.log
logger = file:/var/log/ericsson/unified-ui/private/uwsgi.log
logger = null file:/dev/null
log-format = %(addr) - %(user) [%(ltime)] "%(method) %(uri) %(proto)" %(status) %(size)
# filter out access logs for probe endpoints
log-req-route = null /api/readiness
log-req-route = null /api/liveness
log-date = [%%Y:%%m:%%d %%H:%%M:%%S]
