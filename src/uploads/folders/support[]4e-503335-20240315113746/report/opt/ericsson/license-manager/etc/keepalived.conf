# Define the script used to check if mongod is running
vrrp_script chk_lserv {
    script "/usr/bin/killall -0 /opt/ericsson/license-manager/bin/lserv"
    interval 2 # every two seconds
    weight 2
}

# Define the script to see if the local node is the primary
vrrp_script chk_license-manager {
    script "/usr/bin/killall -0 ericsson-license-api"
    interval 2 # every two seconds
    weight 2
}

vrrp_instance VIP_LM {
    state BACKUP
    interface _INTERFACE_
    virtual_router_id _VIRTUAL_ROUTER_ID_  # Needs to be the same on both instances, and needs to be unique per Guru Controller pair on the same network
    priority 100                   # same value if symetric configuration
    advert_int 1                   # multicast advertisement sent every second
    #nopreempt                     # don't fall back
    virtual_ipaddress {
        _VIP_                   #  interface can also be appended : dev eth0
    }

    # Use the script above to check if we should fail over
    track_script {
        chk_lserv
        chk_license-manager
    }
    notify /opt/ericsson/license-manager/bin/keepalivednotify.sh
}
